{% comment %}
  Modern Product Section
  Styled to match product-hero.liquid but uses actual product data
{% endcomment %}

<product-info
  id="MainProduct-{{ section.id }}"
  class="section-{{ section.id }}-padding gradient color-{{ section.settings.color_scheme }}"
  data-section="{{ section.id }}"
  data-product-id="{{ product.id }}"
  data-update-url="true"
  data-url="{{ product.url }}"
>
  {%- style -%}
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
      padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
    }

    @media screen and (min-width: 750px) {
      .section-{{ section.id }}-padding {
        padding-top: {{ section.settings.padding_top }}px;
        padding-bottom: {{ section.settings.padding_bottom }}px;
      }
    }
  {%- endstyle -%}

  <script src="{{ 'product.js' | asset_url }}" defer="defer"></script>

  <div class="page-width section-{{ section.id }}-padding">
    <div class="product product--{{ section.settings.media_size }} product--{{ section.settings.media_position }} grid grid--1-col {% if product.media.size > 0 %}grid--2-col-tablet{% else %}product--no-media{% endif %}">
      <div class="grid__item product__media-wrapper">
        {% render 'product-media-gallery', variant_images: product.images %}
      </div>
      <div class="product__info-wrapper grid__item">
        <section id="ProductInfo-{{ section.id }}" class="product__info-container">
          {%- assign product_form_id = 'product-form-' | append: section.id -%}

          {%- for block in section.blocks -%}
            {%- case block.type -%}
              {%- when '@app' -%}
                {% render block %}
              
              {%- when 'title' -%}
                <div class="product__title" {{ block.shopify_attributes }}>
                  <h1>{{ product.title | escape }}</h1>
                </div>
              
              {%- when 'price' -%}
                <div id="price-{{ section.id }}" class="price" {{ block.shopify_attributes }}>
                  <span class="price__regular">
                    {{ product.selected_or_first_available_variant.price | money }}
                  </span>
                  {%- if product.selected_or_first_available_variant.compare_at_price > product.selected_or_first_available_variant.price -%}
                    <span class="price__compare">
                      {{ product.selected_or_first_available_variant.compare_at_price | money }}
                    </span>
                  {%- endif -%}
                </div>
              
              {%- when 'description' -%}
                {%- if product.description != blank -%}
                  <div class="product__description rte" {{ block.shopify_attributes }}>
                    {{ product.description }}
                  </div>
                {%- endif -%}
              
              {%- when 'variant_picker' -%}
                {% render 'product-variant-picker', product: product, block: block, product_form_id: product_form_id %}
              
              {%- when 'quantity_selector' -%}
                <div class="product-form__input product-form__quantity" {{ block.shopify_attributes }}>
                  <label class="form__label" for="Quantity-{{ section.id }}">
                    Quantity
                  </label>
                  <div class="quantity">
                    <button class="quantity__button" name="minus" type="button">
                      <span class="visually-hidden">Decrease quantity</span>
                      <span class="svg-wrapper">
                        {{- 'minus.svg' | inline_asset_content -}}
                      </span>
                    </button>
                    <input
                      class="quantity__input"
                      type="number"
                      name="quantity"
                      id="Quantity-{{ section.id }}"
                      min="1"
                      value="1"
                      form="{{ product_form_id }}"
                    >
                    <button class="quantity__button" name="plus" type="button">
                      <span class="visually-hidden">Increase quantity</span>
                      <span class="svg-wrapper">
                        {{- 'plus.svg' | inline_asset_content -}}
                      </span>
                    </button>
                  </div>
                </div>
              
              {%- when 'buy_buttons' -%}
                <div class="product-form__buttons" {{ block.shopify_attributes }}>
                  <button
                    type="submit"
                    name="add"
                    class="button button--full-width button--secondary"
                    {% unless product.selected_or_first_available_variant.available %}disabled{% endunless %}
                    form="{{ product_form_id }}"
                  >
                    {%- if product.selected_or_first_available_variant.available -%}
                      Add to cart
                    {%- else -%}
                      Sold out
                    {%- endif -%}
                  </button>
                </div>
              
              {%- when 'text' -%}
                <p class="product__text" {{ block.shopify_attributes }}>
                  {{- block.settings.text -}}
                </p>
              
              {%- when 'custom_liquid' -%}
                {{ block.settings.custom_liquid }}
              
              {%- when 'collapsible_tab' -%}
                <div class="product__accordion accordion" {{ block.shopify_attributes }}>
                  <details id="Details-{{ block.id }}-{{ section.id }}">
                    <summary>
                      <div class="summary__title">
                        <h2 class="h4 accordion__title">
                          {{ block.settings.heading | default: block.settings.page.title | escape }}
                        </h2>
                      </div>
                      <span class="svg-wrapper">
                        {{- 'chevron-down.svg' | inline_asset_content -}}
                      </span>
                    </summary>
                    <div class="accordion__content rte">
                      {{ block.settings.content }}
                      {{ block.settings.page.content }}
                    </div>
                  </details>
                </div>
                
              {%- when 'rating' -%}
                <div class="product__rating" {{ block.shopify_attributes }}>
                  <div class="rating-stars">
                    {% assign rating = block.settings.rating %}
                    {% assign full_stars = rating | floor %}
                    {% assign has_half = rating | modulo: 1 %}
                    
                    {% for i in (1..5) %}
                      {% if i <= full_stars %}
                        <span class="star star--full">★</span>
                      {% else %}
                        {% assign next_star = full_stars | plus: 1 %}
                        {% if i == next_star and has_half > 0 %}
                          <span class="star star--half">★</span>
                        {% else %}
                          <span class="star star--empty">☆</span>
                        {% endif %}
                      {% endif %}
                    {% endfor %}
                  </div>
                  <span class="rating-value">{{ rating }}</span>
                  <span class="rating-text">{{ block.settings.review_count }}</span>
                </div>
                
              {%- when 'features' -%}
                {%- if block.settings.features != blank -%}
                  <div class="product__features" {{ block.shopify_attributes }}>
                    {% if block.settings.heading != blank %}
                      <h3 class="features__heading">{{ block.settings.heading }}</h3>
                    {% endif %}
                    <ul class="features__list">
                      {%- assign features_array = block.settings.features | split: '\n' -%}
                      {%- for feature in features_array -%}
                        {%- if feature != blank -%}
                          <li class="feature__item">
                            <span class="feature__icon">✓</span>
                            {{ feature | strip }}
                          </li>
                        {%- endif -%}
                      {%- endfor -%}
                    </ul>
                  </div>
                {%- endif -%}
                
              {%- when 'customer_satisfaction' -%}
                <div class="product__customer-satisfaction" {{ block.shopify_attributes }}>
                  <p class="customer-satisfaction__text">{{ block.settings.text }}</p>
                  <div class="customer-avatars">
                    {% if block.settings.avatar_1 %}
                      <img src="{{ block.settings.avatar_1 | image_url: width: 40, height: 40 }}" 
                           alt="Customer" class="customer-avatar" width="40" height="40">
                    {% endif %}
                    {% if block.settings.avatar_2 %}
                      <img src="{{ block.settings.avatar_2 | image_url: width: 40, height: 40 }}" 
                           alt="Customer" class="customer-avatar" width="40" height="40">
                    {% endif %}
                    {% if block.settings.avatar_3 %}
                      <img src="{{ block.settings.avatar_3 | image_url: width: 40, height: 40 }}" 
                           alt="Customer" class="customer-avatar" width="40" height="40">
                    {% endif %}
                    {% if block.settings.avatar_4 %}
                      <img src="{{ block.settings.avatar_4 | image_url: width: 40, height: 40 }}" 
                           alt="Customer" class="customer-avatar" width="40" height="40">
                    {% endif %}
                    {% if block.settings.avatar_5 %}
                      <img src="{{ block.settings.avatar_5 | image_url: width: 40, height: 40 }}" 
                           alt="Customer" class="customer-avatar" width="40" height="40">
                    {% endif %}
                  </div>
                </div>
                
              {%- when 'usp_icons' -%}
                <div class="product__usp-icons" {{ block.shopify_attributes }}>
                  <div class="usp-grid">
                    {% if block.settings.text_1 != blank %}
                      <div class="usp-item">
                        <div class="usp-icon">
                          {{- block.settings.icon_1_name | append: '.svg' | inline_asset_content -}}
                        </div>
                        <span class="usp-text">{{ block.settings.text_1 }}</span>
                      </div>
                    {% endif %}
                    
                    {% if block.settings.text_2 != blank %}
                      <div class="usp-item">
                        <div class="usp-icon">
                          {{- block.settings.icon_2_name | append: '.svg' | inline_asset_content -}}
                        </div>
                        <span class="usp-text">{{ block.settings.text_2 }}</span>
                      </div>
                    {% endif %}
                    
                    {% if block.settings.text_3 != blank %}
                      <div class="usp-item">
                        <div class="usp-icon">
                          {{- block.settings.icon_3_name | append: '.svg' | inline_asset_content -}}
                        </div>
                        <span class="usp-text">{{ block.settings.text_3 }}</span>
                      </div>
                    {% endif %}
                    
                    {% if block.settings.text_4 != blank %}
                      <div class="usp-item">
                        <div class="usp-icon">
                          {{- block.settings.icon_4_name | append: '.svg' | inline_asset_content -}}
                        </div>
                        <span class="usp-text">{{ block.settings.text_4 }}</span>
                      </div>
                    {% endif %}
                  </div>
                </div>
               
            {%- endcase -%}
          {%- endfor -%}
          
          <!-- Product Form -->
          {%- form 'product', product, id: product_form_id, class: 'product-form' -%}
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
          {%- endform -%}
          
        </section>
      </div>
    </div>
  </div>

  {% assign variant_images = product.images %}
  {% render 'product-media-modal', variant_images: variant_images %}

  {%- liquid
    if product.selected_or_first_available_variant.featured_media
      assign seo_media = product.selected_or_first_available_variant.featured_media
    else
      assign seo_media = product.featured_media
    endif
  -%}

  <script type="application/ld+json">
    {{ product | structured_data }}
  </script>
</product-info>

{% stylesheet %}
/* Product Section Styles */
.product {
  display: grid;
  grid-template-columns: 1fr;
  gap: 2rem;
  align-items: start;
}

@media screen and (min-width: 750px) {
  .product {
    grid-template-columns: 1fr 1fr;
  }
  
  .product--right {
    grid-template-columns: 1fr 1fr;
  }
  
  .product--left {
    grid-template-columns: 1fr 1fr;
  }
}

/* Media Gallery */
.product__media-wrapper {
  position: relative;
}

/* Product Info */
.product__info-wrapper {
  padding: 1rem;
}

.product__info-container {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

/* Block Styles */
.product__title h1 {
  font-size: 2rem;
  font-weight: 600;
  margin: 0;
  color: #333;
}

.price {
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 1.5rem;
}

.price__compare {
  text-decoration: line-through;
  color: #999;
}

.product__description {
  line-height: 1.6;
  color: #666;
}

.product-form__input {
  margin-bottom: 1rem;
}

.form__label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 500;
}

.quantity {
  display: flex;
  align-items: center;
  border: 1px solid #ddd;
  border-radius: 4px;
  overflow: hidden;
}

.quantity__button {
  background: #f5f5f5;
  border: none;
  padding: 0.5rem;
  cursor: pointer;
  transition: background-color 0.2s;
}

.quantity__button:hover {
  background: #e5e5e5;
}

.quantity__input {
  border: none;
  text-align: center;
  padding: 0.5rem;
  width: 4rem;
  outline: none;
}

.product-form__buttons {
  margin-top: 1.5rem;
}

.button {
  display: inline-block;
  padding: 1rem 2rem;
  border: none;
  border-radius: 4px;
  text-decoration: none;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
}

.button--full-width {
  width: 100%;
}

.button--secondary {
  background: #007cba;
  color: white;
}

.button--secondary:hover {
  background: #005a87;
}

.button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.product__text {
  margin: 0;
  line-height: 1.6;
}

.product__accordion {
  border: 1px solid #ddd;
  border-radius: 4px;
  margin-bottom: 1rem;
}

.accordion__title {
  margin: 0;
  font-size: 1.1rem;
}

.accordion__content {
  padding: 1rem;
  border-top: 1px solid #ddd;
}

.svg-wrapper {
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.svg-wrapper svg {
  width: 1rem;
  height: 1rem;
}

/* Rating Block */
.product__rating {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.rating-stars {
  display: flex;
  gap: 0.125rem;
}

.star {
  font-size: 1.25rem;
  line-height: 1;
}

.star--full {
  color: #fbbf24;
}

.star--half {
  color: #fbbf24;
  opacity: 0.7;
}

.star--empty {
  color: #d1d5db;
}

.rating-value {
  font-weight: 600;
  color: #333;
}

.rating-text {
  color: #666;
  font-size: 0.875rem;
}

/* Features Block */
.product__features {
  margin-bottom: 1.5rem;
}

.features__heading {
  font-size: 1.125rem;
  font-weight: 600;
  margin: 0 0 1rem 0;
  color: #333;
}

.features__list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.feature__item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  font-size: 0.875rem;
  color: #333;
}

.feature__icon {
  color: #3b82f6;
  font-weight: bold;
  font-size: 1rem;
  flex-shrink: 0;
}

/* Customer Satisfaction Block */
.product__customer-satisfaction {
  margin-bottom: 1.5rem;
}

.customer-satisfaction__text {
  margin: 0 0 0.75rem 0;
  font-size: 0.875rem;
  color: #333;
  font-weight: 500;
}

.customer-avatars {
  display: flex;
  gap: 0.5rem;
}

.customer-avatar {
  border-radius: 50%;
  border: 2px solid white;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* USP Icons Block */
.product__usp-icons {
  margin-bottom: 1.5rem;
}

.usp-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
}

.usp-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  gap: 0.5rem;
}

.usp-icon {
  width: 2rem;
  height: 2rem;
  display: flex;
  align-items: center;
  justify-content: center;
}

.usp-icon svg {
  width: 1.5rem;
  height: 1.5rem;
  color: #333;
}

.usp-text {
  font-size: 0.75rem;
  font-weight: 600;
  color: #333;
  text-align: center;
  line-height: 1.2;
}
{% endstylesheet %}

{% schema %}
{
  "name": "Product",
  "tag": "section",
  "class": "section",
  "blocks": [
    {
      "type": "@app"
    },
    {
      "type": "title",
      "name": "Product Title",
      "limit": 1
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1
    },
    {
      "type": "variant_picker",
      "name": "Variant Picker",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "picker_type",
          "options": [
            {
              "value": "dropdown",
              "label": "Dropdown"
            },
            {
              "value": "button",
              "label": "Button"
            }
          ],
          "default": "dropdown",
          "label": "Picker Type"
        }
      ]
    },
    {
      "type": "quantity_selector",
      "name": "Quantity Selector",
      "limit": 1
    },
    {
      "type": "buy_buttons",
      "name": "Buy Buttons",
      "limit": 1
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "default": "Add your text here",
          "label": "Text"
        }
      ]
    },
    {
      "type": "custom_liquid",
      "name": "Custom Liquid",
      "settings": [
        {
          "type": "liquid",
          "id": "custom_liquid",
          "label": "Custom Liquid",
          "info": "Add custom Liquid code here"
        }
      ]
    },
    {
      "type": "collapsible_tab",
      "name": "Collapsible Tab",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "default": "Tab Heading",
          "label": "Heading"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Content"
        },
        {
          "type": "page",
          "id": "page",
          "label": "Page"
        }
      ]
    },
    {
      "type": "rating",
      "name": "Rating & Reviews",
      "settings": [
        {
          "type": "range",
          "id": "rating",
          "min": 0,
          "max": 5,
          "step": 0.1,
          "default": 4.7,
          "label": "Rating"
        },
        {
          "type": "text",
          "id": "review_count",
          "default": "1000+ Verified Reviews",
          "label": "Review Count Text"
        }
      ]
    },
    {
      "type": "features",
      "name": "Features List",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "default": "Key Features",
          "label": "Heading"
        },
        {
          "type": "textarea",
          "id": "features",
          "default": "Prevents risk from microplastics\nResists bacteria and odors\nKeeps your knives sharp\nEliminates food cross-contamination",
          "label": "Features",
          "info": "Enter each feature on a new line"
        }
      ]
    },
    {
      "type": "customer_satisfaction",
      "name": "Customer Satisfaction",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "default": "8K+ Happy Customers In stock and ready to ship",
          "label": "Text"
        },
        {
          "type": "image_picker",
          "id": "avatar_1",
          "label": "Customer Avatar 1"
        },
        {
          "type": "image_picker",
          "id": "avatar_2",
          "label": "Customer Avatar 2"
        },
        {
          "type": "image_picker",
          "id": "avatar_3",
          "label": "Customer Avatar 3"
        },
        {
          "type": "image_picker",
          "id": "avatar_4",
          "label": "Customer Avatar 4"
        },
        {
          "type": "image_picker",
          "id": "avatar_5",
          "label": "Customer Avatar 5"
        }
      ]
    },
    {
      "type": "usp_icons",
      "name": "USP Icons",
      "settings": [
        {
          "type": "header",
          "content": "USP 1"
        },
        {
          "type": "text",
          "id": "icon_1_name",
          "default": "diamond",
          "label": "Icon 1 Name"
        },
        {
          "type": "text",
          "id": "text_1",
          "default": "PURE TITANIUM",
          "label": "Text 1"
        },
        {
          "type": "header",
          "content": "USP 2"
        },
        {
          "type": "text",
          "id": "icon_2_name",
          "default": "clock",
          "label": "Icon 2 Name"
        },
        {
          "type": "text",
          "id": "text_2",
          "default": "LIFETIME DURABILITY",
          "label": "Text 2"
        },
        {
          "type": "header",
          "content": "USP 3"
        },
        {
          "type": "text",
          "id": "icon_3_name",
          "default": "dollar-sign",
          "label": "Icon 3 Name"
        },
        {
          "type": "text",
          "id": "text_3",
          "default": "30-DAY MONEY-BACK GUARANTEE",
          "label": "Text 3"
        },
        {
          "type": "header",
          "content": "USP 4"
        },
        {
          "type": "text",
          "id": "icon_4_name",
          "default": "shield",
          "label": "Icon 4 Name"
        },
        {
          "type": "text",
          "id": "text_4",
          "default": "ANTIBACTERIAL AND BPA-FREE",
          "label": "Text 4"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "select",
      "id": "color_scheme",
      "options": [
        {
          "value": "accent-1",
          "label": "Accent 1"
        },
        {
          "value": "accent-2",
          "label": "Accent 2"
        },
        {
          "value": "background-1",
          "label": "Background 1"
        },
        {
          "value": "background-2",
          "label": "Background 2"
        }
      ],
      "default": "background-1",
      "label": "Color Scheme"
    },
    {
      "type": "select",
      "id": "media_size",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ],
      "default": "large",
      "label": "Media Size"
    },
    {
      "type": "select",
      "id": "media_position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left",
      "label": "Media Position"
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 36
    }
  ]
}
{% endschema %}


