{% comment %}
  Simple Grid Block Snippet
  Renders individual content blocks within the simple grid system
{% endcomment %}

{% case block.type %}
  {% when 'text' %}
    <div class="simple-grid__text simple-grid__text--{{ block.settings.height | default: 'medium' }}" {{ block.shopify_attributes }} style="
      background-color: {{ block.settings.background_color | default: '#f8f9fa' }};
      text-align: {{ block.settings.text_align | default: 'left' }};
    ">
      {% if block.settings.heading != blank %}
        <h2 style="color: {{ block.settings.heading_color | default: '#333333' }};">{{ block.settings.heading }}</h2>
      {% endif %}
      {% if block.settings.text != blank %}
        <p style="color: {{ block.settings.text_color | default: '#666666' }};">{{ block.settings.text }}</p>
      {% endif %}
    </div>

  {% when 'image' %}
    <div class="simple-grid__image simple-grid__image--{{ block.settings.height | default: 'medium' }}" {{ block.shopify_attributes }} style="
      text-align: {{ block.settings.image_align | default: 'center' }};
    ">
      {% if block.settings.image != blank %}
        {% assign alt_text = block.settings.alt_text | default: block.settings.image.alt %}
        {{ block.settings.image | image_url: width: block.settings.image_width | default: 400 | image_tag: alt: alt_text, loading: 'lazy', style: 'border-radius: ' | append: block.settings.border_radius | default: 8 | append: 'px;' }}
      {% endif %}
    </div>

  {% when 'button' %}
    <div class="simple-grid__button simple-grid__button--{{ block.settings.height | default: 'medium' }}" {{ block.shopify_attributes }}>
      {% if block.settings.button_text != blank and block.settings.button_link != blank %}
        {% assign button_style = block.settings.button_style | default: 'solid' %}
        {% assign button_size = block.settings.button_size | default: 'medium' %}
        {% assign border_radius = block.settings.border_radius | default: 6 %}
        
        {% case button_style %}
          {% when 'solid' %}
            <a href="{{ block.settings.button_link }}" style="
              background-color: {{ block.settings.button_bg_color | default: '#007bff' }};
              color: {{ block.settings.button_text_color | default: '#ffffff' }};
              border: 2px solid {{ block.settings.button_border_color | default: '#007bff' }};
              border-radius: {{ border_radius }}px;
              {% case button_size %}
                {% when 'small' %}padding: 0.5rem 1rem; font-size: 0.875rem;
                {% when 'medium' %}padding: 0.75rem 1.5rem; font-size: 1rem;
                {% when 'large' %}padding: 1rem 2rem; font-size: 1.125rem;
              {% endcase %}
            ">{{ block.settings.button_text }}</a>
          {% when 'outline' %}
            <a href="{{ block.settings.button_link }}" style="
              background-color: transparent;
              color: {{ block.settings.button_bg_color | default: '#007bff' }};
              border: 2px solid {{ block.settings.button_border_color | default: '#007bff' }};
              border-radius: {{ border_radius }}px;
              {% case button_size %}
                {% when 'small' %}padding: 0.5rem 1rem; font-size: 0.875rem;
                {% when 'medium' %}padding: 0.75rem 1.5rem; font-size: 1rem;
                {% when 'large' %}padding: 1rem 2rem; font-size: 1.125rem;
              {% endcase %}
            ">{{ block.settings.button_text }}</a>
          {% when 'ghost' %}
            <a href="{{ block.settings.button_link }}" style="
              background-color: transparent;
              color: {{ block.settings.button_bg_color | default: '#007bff' }};
              border: 2px solid transparent;
              border-radius: {{ border_radius }}px;
              {% case button_size %}
                {% when 'small' %}padding: 0.5rem 1rem; font-size: 0.875rem;
                {% when 'medium' %}padding: 0.75rem 1.5rem; font-size: 1rem;
                {% when 'large' %}padding: 1rem 2rem; font-size: 1.125rem;
              {% endcase %}
            ">{{ block.settings.button_text }}</a>
        {% endcase %}
      {% endif %}
    </div>

  {% when 'html' %}
    <div class="simple-grid__html simple-grid__html--{{ block.settings.height | default: 'medium' }}" {{ block.shopify_attributes }} style="
      background-color: {{ block.settings.background_color | default: '#f8f9fa' }};
    ">
      {% if block.settings.html_content != blank %}
        {{ block.settings.html_content }}
      {% endif %}
    </div>

  {% when 'spacer' %}
    <div class="simple-grid__spacer simple-grid__spacer--{{ block.settings.height | default: 'medium' }}" {{ block.shopify_attributes }}></div>

  {% when 'divider' %}
    <div class="simple-grid__divider simple-grid__divider--{{ block.settings.height | default: 'medium' }}" {{ block.shopify_attributes }} style="
      background-color: {{ block.settings.divider_color | default: '#e5e7eb' }};
    "></div>

  {% when 'app' %}
    <div class="simple-grid__app simple-grid__app--{{ block.settings.height | default: 'medium' }}" {{ block.shopify_attributes }} style="
      background-color: {{ block.settings.background_color | default: '#f8f9fa' }};
    ">
      {% if block.settings.app_handle != blank %}
        {% comment %} Try to render the app section {% endcomment %}
        {% assign app_section = block.settings.app_handle %}
        {% if app_section contains 'kaching' or app_section contains 'bundle' %}
          <div class="simple-grid__app-placeholder">
            <div class="simple-grid__app-icon">ðŸ“¦</div>
            <h4>Kaching Bundles</h4>
            <p>App section will be displayed here</p>
            <small>Add the Kaching Bundles app section to your theme to see it here</small>
          </div>
        {% else %}
          <div class="simple-grid__app-content">
            <div class="simple-grid__app-icon">ðŸ”Œ</div>
            <h4>App Section</h4>
            <p>{{ app_section | handleize | replace: '-', ' ' | capitalize }}</p>
            <small>App content will appear here</small>
          </div>
        {% endif %}
      {% else %}
        <div class="simple-grid__app-content">
          <div class="simple-grid__app-icon">ðŸ”Œ</div>
          <h4>App Section</h4>
          <p>Enter an app section handle to display it here</p>
          <small>Example: kaching-bundles</small>
        </div>
      {% endif %}
    </div>
{% endcase %}
